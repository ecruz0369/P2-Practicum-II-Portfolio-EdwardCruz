---
title: "Group 10 Final Project"
output: html_document
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# load a few R packages
library(here)
library(knitr)
library(ggplot2)
library(dplyr)
library(scales)
library(showtext)
library(ggimage)

```

# Summary/Abstract

Group Ten is conducting a comprehensive analysis of historical data from
various public agencies to evaluate the impact of Varroa mites, American
Foulbrood, and global warming on hive losses in the United States.This
research utilizes extensive datasets from the National Agricultural
Statistics Service, the Agricultural Statistics Board, and the United
States Department of Agriculture (USDA), encompassing multiple years of
data. The data highlights the topic on hive losses attributed to mites,
bacterial infections, and environmental factors related to global
warming. Through advanced data visualization techniques in R, we aim to
demonstrate and validate the detrimental effects of these factors on
honeybee colonies, highlighting the consequent implications for honey
production and broader food security. ***Dennis and Kemp's study on
honey bee hive collapse [@hivecollapse] provides important insights into
Allee effects and ecological resilience.***

{{< pagebreak >}}

# Introduction

Honeybees have served as nature's pollinators for centuries. With their
relationship with humans documented as far back as ancient Egyptian and
Hindu cultures. Historically, humans have maintained beehives and
utilized honey for its medicinal properties in various civilizations,
including the Egyptians, Assyrians, Chinese, Greeks, and Romans. Honey's
natural antibacterial qualities made it a valuable treatment for wounds.
This was a practice continued by Romans and Russians during World War I.
Honeybees and other pollinators are essential for food production and
nutritional security. But even though they face numerous survival
challenges Varroa mites pose a significant threat to bee colonies. These
tiny red-brown parasites live on adult honeybees and reproduce on larvae
and pupae. Another major threat is American Foulbrood Disease (AFB).
This is caused by the bacterium Paenibacillus larvae, which is fatal to
honeybee larvae and requires incineration of infected hives to prevent
its spread. The impact of climate change on honeybee colony losses is a
growing area of research. While correlations have been found between
higher winter temperatures and increased colony losses, the effects of
warmer autumn and winter temperatures on colony dynamics and survival
require further investigation. ***Dennis and Kemp's study on honey bee
hive collapse [@hivecollapse] provides important insights into Allee
effects and ecological resilience.***[@usda_honey_bees; @usda_nass]



```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Create a data frame with the composition of honey
honey_data <- data.frame(
  component = c("Fructose", "Glucose", "Water", "Maltose", "Trisaccharides, Carbohydrates", "Sucrose", "Minerals, Vitamins, Enzymes"),
  percentage = c(38.5, 31.0, 17.1, 7.2, 4.2, 1.5, 0.5)
)

# Define colors for the segments
honey_data$color <- c("#FFA726", "#FB8C00", "#FFD54F", "#FFB74D", "#90CAF9", "#F06292", "#BA68C8")

# Plot with ggplot2
ggplot(honey_data, aes(x = "", y = percentage, fill = component)) +
  geom_bar(width = 0.8, stat = "identity", color = "white") +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = honey_data$color) +
  geom_text(aes(x=1.8, label = paste0(percentage, "%")), position = position_stack(vjust = 0.6), size = 3, color = "black") +
  labs(
    title = "COMPOSITION OF HONEY",
    subtitle = "Illustration of honey components by percentage",
    fill = NULL
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 22, face = "bold", hjust = 0.5, family = "lobster"),
    plot.subtitle = element_text(size = 14, hjust = 0.5),
    legend.position = "bottom",
    legend.text = element_text(size = 12)
  )
```
### Composition of Honey

Compositions of honey is a pie chart that illustrates the composition of honey
by percentage. The main components are:

-   **Fructose**: 38.5%
-   **Glucose**: 31%
-   **Water**: 17.1%
-   **Maltose**: 7.2%
-   **Other components**:
    -   Sucrose: 1.5%
    -   Minerals, Vitamins, Enzymes: 0.5%
    -   Trisaccharides, Carbohydrates: 4.2%

This composition indicates that honey is primarily made up of sugars,
specifically fructose and glucose, with water being the third major
component. The presence of minerals, vitamins, and enzymes, though in
smaller amounts, adds nutritional value to honey. This detailed
breakdown underscores honey's role as a natural sweetener with
additional health benefits beyond its primary carbohydrate content.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(sf)
library(maps)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
states <- st_as_sf(map("state", plot = FALSE, fill = TRUE))
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
varroa_data <- data.frame(
  state = c("alabama", "alaska", "arizona", "arkansas", "california", "colorado", 
            "connecticut", "delaware", "florida", "georgia", "hawaii", "idaho", 
            "illinois", "indiana", "iowa", "kansas", "kentucky", "louisiana", 
            "maine", "maryland", "massachusetts", "michigan", "minnesota", 
            "mississippi", "missouri", "montana", "nebraska", "nevada", "new hampshire", 
            "new jersey", "new mexico", "new york", "north carolina", "north dakota", 
            "ohio", "oklahoma", "oregon", "pennsylvania", "rhode island", 
            "south carolina", "south dakota", "tennessee", "texas", "utah", 
            "vermont", "virginia", "washington", "west virginia", "wisconsin", "wyoming"),
  year = c("1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995",
           "1986 - 1987", "1988 - 1989", "1990 - 1991", "1992 - 1993", "1994 - 1995")
)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
states <- merge(states, varroa_data, by.x = "ID", by.y = "state", all.x = TRUE)
```



```{r, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(data = states) +
  geom_sf(aes(fill = year), color = "#292929", size = 0.2) +
  scale_fill_manual(
    values = c(
      "1986 - 1987" = "#CD2626", 
      "1988 - 1989" = "#CD9B1D", 
      "1990 - 1991" = "#FFD700", 
      "1992 - 1993" = "#00CD00", 
      "1994 - 1995" = "#104E8B"
    ),
    na.value = "#757575"
  ) +
  theme_minimal() +
  labs(
    title = "Spread of Varroa Mites",
    fill = "Year of First Appearance"
  )

```
### Spread of Varroa Mites

the spread of varroa mites image is a map illustrating the spread of Varroa mites in the
United States from 1986 to 1995. The map uses different colors to
represent the year of the first appearance of Varroa mites in each
state:

-   **1986 - 1987**: Red
-   **1988 - 1989**: Yellow
-   **1990 - 1991**: Green
-   **1992 - 1993**: Blue
-   **1994 - 1995**: Grey
-   **NA**: States where data is not available

The map reveals the progressive spread of Varroa mites from the
mid-1980s to the mid-1990s, affecting bee colonies across the country.
The earliest appearances were concentrated in specific regions and
gradually spread to more states over time. This visual representation
highlights the increasing geographical distribution of Varroa mites and
underscores the growing challenge they pose to beekeeping and
agricultural industries in the United States.

***[@varroamap] Varroa Map of infestation periods***

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary libraries
library(tidyverse)

# Create a data frame with the provided data
data <- tibble(
  Year = 1901:2023,
  `Earth's surface` = c(-0.15, -0.43, -1.4, -0.86, -1.02, -0.29, -0.54, 0.06, -0.59, 0.4, 0.01, -1.79, -0.48, -0.18, -0.57, -1.17, -1.96, -0.15, -0.47, -0.95, 1.78, 0.01, -0.38, -1.43, 0.5, -0.07, 0.13, -0.1, -1.17, -0.04, 1.52, -0.29, 0.97, 2.08, -0.12, 0.13, -0.47, 1.16, 1.24, -0.13, 0.64, -0.18, 0.05, -0.19, -0.27, 0.93, -0.1, -0.41, 0, -0.63, -0.9, 0.25, 1.35, 1.31, -0.33, 0.32, 0.02, -0.09, 0.09, -0.58, -0.15, -0.12, 0.24, -0.35, -0.33, -0.53, -0.26, -0.7, -0.52, -0.41, -0.36, -0.65, 0.27, 0.24, -0.52, -0.55, 0.53, -0.97, -1.14, 0.37, 1.1, -0.67, -0.14, -0.04, -0.72, 1.3, 1.31, 0.61, -0.18, 1.49, 1.14, 0.58, -0.76, 0.85, 0.63, -0.13, 0.18, 2.21, 1.86, 1.25, 1.68, 1.19, 1.24, 1.08, 1.62, 2.23, 1.63, 0.27, 0.37, 0.96, 1.16, 3.26, 0.41, 0.52, 2.38, 2.9, 2.53, 1.5, 0.66, 2.35, 2.49, 1.37, 2.39),
  `Lower troposphere (UAH)` = c(rep(NA, 78), 0.049093434, 0.731593434, 1.102093434, 0.008593434, 0.034093434, 0.292093434, 0.110593434, 1.220593434, 1.054093434, 0.698593434, 0.548593434, 1.451593434, 1.031593434, 0.484093434, -0.174406566, 1.043593434, 0.797593434, 0.502093434, 0.457093434, 1.691593434, 1.796593434, 1.351093434, 1.255093434, 0.994093434, 1.223593434, 0.769093434, 1.303093434, 1.444093434, 1.765093434, 0.467593434, 0.524593434, 0.929593434, 1.013593434, 1.955593434, 0.655093434, 0.763093434, 2.234593434, 2.030593434, 2.252593434, 1.645093434, 1.133593434, 1.970593434, 2.059093434, 1.567093434, NA),
  `Lower troposphere (RSS)` = c(rep(NA, 78), -0.808971111, 0.178178889, 0.658778889, -0.579771111, -0.383871111, -0.217371111, -1.053021111, 0.737978889, 1.111328889, 0.557978889, 0.221828889, 1.280228889, 1.043228889, 0.585278889, -0.261321111, 1.078178889, 0.772628889, 0.278078889, 0.418178889, 1.911578889, 1.882928889, 1.471328889, 1.536578889, 1.144628889, 1.465628889, 1.058528889, 1.583078889, 1.749278889, 1.858928889, 0.503378889, 0.595928889, 0.997028889, 1.109378889, 2.677328889, 0.696278889, 0.781478889, 2.547878889, 2.476328889, 2.350478889, 1.793978889, 1.221428889, 2.290628889, 2.485328889, 1.596878889, 1.886228889)
)
# Pivot the data for plotting
data_long <- data %>%
  pivot_longer(cols = c(`Earth's surface`, `Lower troposphere (UAH)`, `Lower troposphere (RSS)`), 
               names_to = "Measurement", values_to = "Temperature")

# Create the plot
ggplot(data_long, aes(x = Year, y = Temperature, color = Measurement)) +
  geom_line(size = 1) +
  geom_point(size = 1.5) +
  theme_minimal() +
  labs(
    title = "Temperature Changes Over the Years",
    x = "Year",
    y = "Temperature Anomaly (°C)",
    color = "Measurement"
  ) +
  scale_color_manual(values = c("Earth's surface" = "#254976", "Lower troposphere (UAH)" = "#4A8C1D", "Lower troposphere (RSS)" = "#B5153A"))

```

The chart provided illustrates the changes in temperature anomalies over the years, from 1900 to approximately 2025. The temperature anomaly, measured in degrees Celsius (°C), is plotted on the y-axis, while the years are plotted on the x-axis. The data is divided into three different measurements: Earth's surface, lower troposphere (RSS), and lower troposphere (UAH), each represented by different colors (blue, red, and green respectively).

### Detailed Description:
- **Trend Analysis**:
  - From 1900 to around 1975, the Earth's surface temperature shows considerable variability with some notable periods of cooling and warming.
  - Post-1975, there is a distinct upward trend in temperature anomalies for all three measurements, indicating a general warming trend.
- **Measurement Comparison**:
  - The Earth's surface (blue line) shows the most extended historical data and fluctuates more in the earlier years compared to the troposphere measurements.
  - The lower troposphere measurements (RSS in red and UAH in green) start around 1975 and generally follow the same upward trend as the surface measurements but with less variability.
  - The RSS and UAH measurements align closely with each other post-2000, indicating consistent trends in the lower troposphere temperature anomalies.
- **Anomalies & Peaks**:
  - The Earth's surface shows significant peaks and troughs, especially in the early 20th century and around the year 2000.
  - The lower troposphere measurements show peaks and align closely, particularly after the year 2000, reflecting similar patterns in temperature anomalies.

### Key Points:
- The overall trend shows an increase in temperature anomalies from 1900 to 2025.
- Significant variability is seen in Earth's surface temperatures in the early years.
- Post-1975, a clear warming trend is observed across all measurements.
- Lower troposphere data (RSS and UAH) begins around 1975 and follows the Earth's surface trend with less variability.
- Post-2000, the RSS and UAH data closely align, indicating consistent temperature trends in the lower troposphere.
- There are noticeable peaks in the temperature anomalies around the year 2000 and later, reflecting periods of significant temperature increases.

### Impact on Bees, Varroa Mites, and Colony Loss:
- **Bees**:
  - **Thermal Stress**: Increased temperature anomalies can cause thermal stress on bees, affecting their ability to forage, navigate, and perform essential colony tasks.
  - **Floral Resources**: Warming temperatures can alter the availability and distribution of floral resources, impacting bee nutrition and health.
  - **Reproduction Cycles**: Changes in temperature can disrupt the reproductive cycles of bees, potentially leading to mismatches with the availability of pollen and nectar.

- **Varroa Mites**:
  - **Increased Reproduction**: Warmer temperatures can accelerate the reproduction rates of varroa mites, exacerbating infestations within bee colonies.
  - **Extended Activity Period**: Higher temperatures can lengthen the active period of varroa mites throughout the year, leading to prolonged periods of stress on bee populations.

- **Colony Loss**:
  - **Health Decline**: Combined effects of thermal stress on bees and increased varroa mite infestations can lead to a decline in colony health.
  - **Colony Collapse Disorder (CCD)**: Temperature anomalies can contribute to conditions that favor Colony Collapse Disorder, where the majority of worker bees disappear, leaving behind the queen and immature bees.
  - **Mortality Rates**: Sustained temperature increases can lead to higher mortality rates within bee colonies, significantly impacting beekeeping and agricultural pollination services.

### Conclusion:
The chart highlights a clear trend of increasing temperature anomalies, which can have profound implications on bee populations, varroa mite dynamics, and overall colony health. Understanding these trends is crucial for developing strategies to mitigate the adverse effects on bees and ensure the sustainability of pollination services essential for ecosystems and agriculture.


[@epa_climate_indicator] ***Global warming trends from 1900-2024***

***Spread of Varroa Mite by Year of First Apperance [@varroamap]***
Written By:sdns6mchl4. (2016, February 24). Varroa mite spread in the
United States. Beesource Beekeeping Forums.
https://www.beesource.com/threads/varroa-mite-spread-in-the-united-states.365462/

\## General Background Information

### **Uncapped Honey Floresville,Texas Hive**

![](/images/Bee%20Frame%202024.jpg){fig-align="center"}

### **Capped Honey one Month Later same hive frame- Italian bees Floresville, Texas**

![](/images/Bee%20Frame%20Capped%20Honey.jpg){fig-align="center"}

## Description of data and data source

### Data Sources

Bee colonies maintained by beekeepers are classified as livestock by the USDA due to their production of honey, a consumable food item, and their critical role in pollination during crop seasons. Given the importance of bee colonies in agriculture, we sourced data from two authoritative websites:

1. **USDA National Agricultural Statistics Service (NASS)**:
   - Provides comprehensive agricultural data, including statistics on honey production and colony health.
   - Source: [USDA - National Agricultural Statistics Service - Surveys - honey bee surveys and reports](https://www.nass.usda.gov/Surveys/Guide_to_NASS_Surveys/Bee_and_Honey/).

2. **Bee Informed Partnership**:
   - Offers detailed insights and research on bee colony management and health, contributing valuable information on the status and trends of bee populations.
   - Source: [Index Catalog // USDA Economics, Statistics and Market Information System](https://usda.library.cornell.edu/catalog?f%5Bkeywords_sim%5D%5B%5D=honey+bees&locale=en).

These sources provided reliable and extensive data necessary for analyzing the factors affecting bee colonies, honey production, and the broader implications for agriculture.

## Questions/Hypotheses to be addressed

### Hypotheses

**Hypothesis**:
"The negative impacts of mites, bacterium, and global warming have detrimental effects on honeybee colonies in the United States and Texas, which in turn will lead to a decline in honey production and negatively impact food production." This hypothesis can be tested and validated through a visualization of outcomes using R, demonstrating the relationship between these factors and their effects on honeybee colonies.

**Null Hypothesis (H0)**:
The impacts of mites, bacterium, and global warming do not have a significant detrimental effect on honeybee colonies in the United States and Texas, and there is no consequent decline in honey production or negative impact on food production.

**Alternative Hypothesis (H1)**:
The impacts of mites, bacterium, and global warming have a significant detrimental effect on honeybee colonies in the United States and Texas, leading to a decline in honey production and negatively impacting food production.

These hypotheses will be tested using various data visualization techniques in R, allowing us to explore and validate the relationships between these factors and their effects on honeybee colonies.

### **Bacterium Infection Foul Brood**

![](/images/American-Foul-Brood-Comb-1024x768-1.jpg){fig-align="center"}

### **Dead bees resulting from extreme heat found in hive**

![](/images/dead-bees-hive-colony-collapse-600nw-2289939105.webp)

#Citation section To cite other work (important everywhere, but likely
happens first in introduction), make sure your references are in the
bibtex file specified in the YAML header above and have the right bibtex
key. Then you can include like this:

Examples of reproducible research projects can for instance be found in
[@mckay2020; @mckay2020a].

#Here are the BibTex entries for citations:

Using this in RMarkdown: #Make sure to save these entries in a file
names'reference.bib' and include it in your R Markdown document like
this:

{{< pagebreak >}}

# Methodology


## Schematic of workflow

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(DiagrammeR)

DiagrammeR::grViz("
digraph G {

  node [shape = box, style = filled, color = lightblue, fontname = Helvetica]

  subgraph cluster_0 {
    label = 'Analytical Report Workflow'
    
    Introduction -> Data_Acquisition -> Data_Cleaning_Preparation -> Exploratory_Data_Analysis -> Data_Visualization -> Advanced_Statistical_Analysis -> Results_Discussion -> Conclusion -> Appendix -> References
  }

  Introduction [label = '1. Introduction']
  Data_Acquisition [label = '2. Data Acquisition']
  Data_Cleaning_Preparation [label = '3. Data Cleaning and Preparation']
  Exploratory_Data_Analysis [label = '4. Exploratory Data Analysis (EDA)']
  Data_Visualization [label = '5. Data Visualization']
  Advanced_Statistical_Analysis [label = '6. Advanced Statistical Analysis']
  Results_Discussion [label = '7. Results and Discussion']
  Conclusion [label = '8. Conclusion']
  Appendix [label = '9. Appendix']
  References [label = '10. References']
}
")
```


```{r, echo=FALSE, message=FALSE, warning=FALSE}

#knitr::include_graphics(here("assets","antigen-recognition.png"))
```

## Data aquisition

### Data Acquisition

We sourced our data from the United States Department of Agriculture (USDA), leveraging their comprehensive and authoritative datasets. This data provided crucial information for our analysis, including statistics on honey production, colony health, and factors affecting bee populations. Utilizing USDA data ensured the reliability and relevance of our analysis, as it encompasses extensive, well-documented records pertinent to agricultural and ecological studies.

## Data import and cleaning

### Data Cleaning and Preparation

We integrated data from multiple datasets to ensure a comprehensive analysis. The cleaning process involved several key steps:

1. **Removal of Irrelevant Data**:
   - **Blank Spaces**: We eliminated any blank spaces within the datasets to ensure data integrity.
   - **Non-Pertinent Columns**: Columns that were not directly related to our analysis objectives were removed to streamline the dataset.

2. **Filtering Observations**:
   - **Focus on Relevant Data**: We filtered out observations that did not directly pertain to our study, specifically those not related to the causes of bee colony losses.
   - **Loss Data**: The dataset was refined to single out data representing the losses attributed to mites and climate change, allowing us to focus on these critical factors.

3. **Exploratory Focus**:
   - **State and Year Analysis**: By focusing on data that represented colony losses across different states and years, we aimed to explore the geographical and temporal impacts of these factors on bee colonies.

These steps ensured that our dataset was clean, relevant, and well-prepared for subsequent analysis, enabling a focused exploration of the causes of bee colony losses and their relationship with mites and climate change.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(readxl)
library(tidyverse)
library(ggplot2)
library(knitr)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}

library(here)


# Install and load the here package
#install.packages("here")
library(here)

# Create a 'data' directory within the project
dir.create(here("data"))



# Read the CSV file
data <- read.csv(here("Databystate.csv"))


#data <- read.csv("C:/Users/ecruz/OneDrive/Documents/UTSA - Data Science Program/Semester Classes/Practicum II #Repository/P2-Practicum-II-Portfolio-EdwardCruz/DatabyState.csv")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Select all columns except 3, 6, and 9
Data_Clean <- dplyr::select(data, -c(3, 6, 9))
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Output cleaned data file to a csv file.

write.csv(Data_Clean, "Data_Clean.csv", row.names = FALSE)

#write.csv(Data_Clean, "C:/Users/ecruz/OneDrive/Documents/UTSA - Data Science Program/Semester Classes/Practicum II #Repository/P2-Practicum-II-Portfolio-EdwardCruz/docs/Databystate_Clean.csv")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Assuming your data frame is named "data"

# Filter for rows where "Loss" or "Deadout" is present in any column (case-insensitive)

library(stringr)  # Load stringr package for regular expressions
data_filtered <- Data_Clean[rowSums(sapply(data, grepl, pattern = c("Loss"), ignore.case = TRUE)) > 0, ]
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Output cleaned data file to a csv file.

write.csv(data_filtered, "Data_Filtered.csv", row.names = FALSE)

#write.csv(Data_Clean, "C:/Users/ecruz/OneDrive/Documents/UTSA - Data Science Program/Semester Classes/Practicum II #Repository/P2-Practicum-II-Portfolio-EdwardCruz/docs/Databystate_Filtered.csv")
```



```{r, echo=FALSE, message=FALSE, warning=FALSE}

# Load necessary libraries
library(ggplot2)
library(here)


# Load the dataset
data_filtered <- read.csv(here::here("Data_Filtered.csv"), stringsAsFactors = FALSE)

# Convert 'Value' to numeric
data_filtered$Value <- as.numeric(gsub(",", "", data_filtered$Value))

# Handle missing values by replacing NAs with the median value
data_filtered$Value[is.na(data_filtered$Value)] <- median(data_filtered$Value, na.rm = TRUE)

# Boxplot of Value by Year and Data.Item
ggplot(data_filtered, aes(x = factor(Year), y = Value, fill = Data.Item)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(labels = comma) +
  labs(title = "Boxplot of Value by Year and Data.Item", x = "Year", y = "Value") +
  theme_minimal()
```


### Analysis of Boxplot

The boxplot illustrates the distribution of values for "LOSS, COLONY COLLAPSE DISORDER" and "LOSS, DEADOUT" across the years 2015 to 2017. A few key observations can be made from the data:

**Central Tendency and Spread**:
   - The median values for both types of losses (represented by the central line in each box) are relatively low across all years, indicating that the majority of losses are concentrated towards the lower end of the scale.

**Yearly Comparison**:
   - For the year 2015, the losses due to Colony Collapse Disorder and Deadout are higher compared to the subsequent years. This can be observed from the height of the boxes and the spread of the data points.
   - There is a noticeable decrease in the losses for both categories in 2016 and 2017. The boxes for these years are smaller and closer to the x-axis, indicating lower values.

**Outliers**:
   - There are significant outliers present in all years for both types of losses. These outliers indicate that while most of the data points are clustered around the lower values, there are instances of very high losses that deviate from the norm.

**Comparison between Loss Types**:
   - The distribution of "LOSS, DEADOUT" appears to have more variability compared to "LOSS, COLONY COLLAPSE DISORDER", particularly in 2015 and 2016. This is indicated by the wider interquartile ranges and more spread out data points.

**Overall Trends**:
   - Overall, the boxplot suggests a decline in both types of losses from 2015 to 2017. However, the presence of outliers in each year indicates that there are still occasional severe loss events.


This highlights the trends and variations in honeybee colony losses due to Colony Collapse Disorder and Deadout over a three-year period, providing insights into the distribution and severity of these losses.



```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Scatterplot of Value by State.ANSI
ggplot(data_filtered, aes(x = State.ANSI, y = Value, color = factor(Year))) +
  geom_point() +
  scale_y_continuous(labels = comma) +
  labs(title = "Scatterplot of Value by State.ANSI", x = "State.ANSI", y = "Value") +
  theme_minimal()



```

### Analysis of Scatterplot




The scatterplot visualizes the distribution of values across different states (represented by State ANSI codes) for the years 2015, 2016, and 2017. Several key observations can be drawn from the data:

**Value Distribution Across States**:
   - The values vary significantly across different states. Most states have relatively low values, but there are notable exceptions with very high values.

**Yearly Trends**:
   - In 2015, there are multiple high values, especially at the lower end of the State ANSI codes. These are represented by the red dots.
   - In 2016, represented by green dots, there are fewer high values, but some extreme outliers are present, such as the one exceeding 200,000.
   - In 2017, indicated by blue dots, the values are generally lower compared to the previous years, with fewer extreme outliers.

**Outliers**:
   - Each year has significant outliers that deviate from the general trend of low values across states. These outliers suggest occasional severe losses in specific states.

**State-Specific Trends**:
   - Certain states (e.g., those with lower ANSI codes) exhibit higher variability and more frequent high values compared to others.
   - States towards the middle and higher end of the ANSI scale generally show more consistent, lower values.

**Comparative Analysis**:
   - The plot indicates that while overall losses may be high in certain states, the distribution and frequency of these high values vary across years. This suggests possible changes in factors affecting bee colony losses over time.

This shows the distribution and variability of bee colony losses across different states over three years, providing insights into state-specific trends and the presence of extreme loss events.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary library
library(ggplot2)
library(scales)


# Assuming data_filtered is already loaded and has the required columns

# Create the plot
p <- ggplot(data_filtered, aes(x = Period, y = Value, fill = Data.Item)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  scale_y_continuous(labels = comma) +
  labs(title = "Boxplot of Value by Period and Data.Item", x = "Period", y = "Value")

# Print the plot
print(p)


```

### Analysis of Boxplot


The boxplot illustrates the distribution of values for "LOSS, COLONY COLLAPSE DISORDER" and "LOSS, DEADOUT" across different periods of the year. The data is segmented into four periods: APR-THRU-JUN, JAN-THRU-MAR, JUL-THRU-SEP, and OCT-THRU-DEC. Several key observations can be made from the data:

**Central Tendency and Spread**:
   - The median values for both types of losses are low across all periods, indicating that most losses are concentrated towards the lower end of the scale.
   - The interquartile ranges (IQRs) for "LOSS, DEADOUT" are relatively consistent across periods, suggesting stable variability in losses throughout the year.

**Period Comparison**:
   - The period JUL-THRU-SEP shows the highest median value for "LOSS, DEADOUT," indicating that this period might be particularly challenging for bee colonies.
   - The period JAN-THRU-MAR has a few outliers but generally shows lower losses compared to other periods.

**Outliers**:
   - Significant outliers are present in all periods for both types of losses. These outliers suggest occasional severe loss events that deviate significantly from the norm.
   - The period APR-THRU-JUN shows the highest outlier for "LOSS, COLONY COLLAPSE DISORDER," indicating some extreme events during this time.

**Comparison between Loss Types**:
   - "LOSS, DEADOUT" consistently shows a wider range of values compared to "LOSS, COLONY COLLAPSE DISORDER" across all periods, suggesting more variability in deadout losses.

**Overall Trends**:
   - The plot suggests that while losses occur throughout the year, there are specific periods (e.g., JUL-THRU-SEP) where losses might be higher.
   - The consistent presence of outliers indicates that, despite general trends, extreme loss events are a recurring issue.


This boxplot shows insights into the seasonal variability of bee colony losses due to Colony Collapse Disorder and Deadout, highlighting specific periods with higher losses and the presence of extreme loss events.

### Overall Analysis

-   The composition of honey indicates its high sugar content, essential
    for energy but also highlighting the presence of beneficial
    components like enzymes and vitamins.
-   The spread of Varroa mites map highlights the widespread and growing
    impact of these pests over time, emphasizing the need for ongoing
    management and control efforts.
-   The boxplots and scatterplots provide a detailed view of the
    variability and trends in colony losses due to different factors,
    both over time and across different regions. These plots suggest
    that while losses are a consistent issue, their magnitude and causes
    can vary widely, pointing to the need for tailored strategies to
    address colony health.

These visualizations collectively provide a comprehensive overview of
the challenges faced by bee colonies, from composition and health to
external threats like Varroa mites and seasonal variations in losses.

### **VARROA MITE EXPOSED**

![](/images/_20220406_on_varroadestructor_minden_00463080.jpg){fig-align="center"}

### **VARROA MITE**

![](/images/Varrpa%201.webp){fig-align="center" width="527"}

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load necessary libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(reshape2)
library(cluster)
library(car)
library(factoextra)
library(rpart)
library(rpart.plot)
library(randomForest)
library(e1071)

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Load your dataset
# Assuming your data frame is named 'data_hcny'

data_hcny <- read.csv(here("hcny_CleanDraft.csv"))


#data_hcny <- read.csv("C:/Users/Leonel/Desktop/MSDA/MS Data Analytics/Current Class/DA 6833/Practicum 2 Github/leonelsalazar-P2-portfolio/Group Project/hcnydata_cleaned.csv")

data_clean <- na.omit(data_hcny)



```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Descriptive Statistics
print("Descriptive Statistics:")
summary(data_clean)
str(data_clean)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Visualizations

# Bar Plot for varroa_mites by State
ggplot(data_clean, aes(x = state, y = varroa_mites)) +
  geom_bar(stat = "identity") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Varroa Mites by State", y = "Percentage", x = "State")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
str(data_clean)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Stacked Bar Plot
data_long <- data_clean %>%
  gather(key = "factor", value = "percentage", -state)

ggplot(data_long, aes(x = state, y = percentage, fill = factor)) +
  geom_bar(stat = "identity") +
 theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Factors Affecting Bees by State", y = "Percentage", x = "State")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Heatmap
data_melt <- melt(data_clean, id.vars = "state")

ggplot(data_melt, aes(x = variable, y = state, fill = value)) +
  geom_tile() +
  scale_fill_gradient(low = "white", high = "red") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
  labs(title = "Heatmap of Factors Affecting Bees", y = "State", x = "Factor")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Pie Chart for the United States
us_data <- data_clean %>%
  filter(state == "United States") %>%
  dplyr::select(-state) %>%
  gather(key = "factor", value = "percentage")

ggplot(us_data, aes(x = "", y = percentage, fill = factor)) +
  geom_bar(width = 1, stat = "identity") +
  coord_polar("y") +
  theme_void() +
  labs(title = "Distribution of Factors Affecting Bees in the United States")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Correlation Analysis
cor_data <- cor(data_clean[,-1])
print("Correlation Matrix:")
print(cor_data)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Assumption Checks for Descriptive Analysis
print("Assumption Checks:")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Normality check
shapiro_results <- lapply(data_clean[-1], function(column) shapiro.test(column))
print("Shapiro-Wilk Test for Normality:")
print(shapiro_results)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Homogeneity of variances

levene_results <- leveneTest(varroa_mites ~ state, data = data_clean)
print("Levene's Test for Homogeneity of Variances:")
print(levene_results)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Cluster Analysis
data_cluster <- data_clean %>%
  filter(state != "United States") %>%
  dplyr::select(-state)

hc <- hclust(dist(data_cluster), method = "complete")
plot(hc, labels = data_clean$state[data_clean$state != "United States"], main = "Hierarchical Clustering of States")
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Principal Component Analysis (PCA)
data_pca <- data_clean %>%
  filter(state != "United States") %>%
  dplyr::select(-state) %>%
  scale()
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
pca_result <- prcomp(data_pca, center = TRUE, scale. = TRUE)
summary(pca_result)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
fviz_pca_var(pca_result, col.var = "contrib", gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"))

```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
str(data_clean)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Support Vector Machine (SVM)
svm_model <- svm(varroa_mites ~ other_pests + disease + pesticides + other + unknown, data = data_clean)
summary(svm_model)
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Assuming predictions and data_clean$varroa_mites are already created

# Example data
data_clean <- data.frame(
  Varroa_Mites = c(5, 10, 15, 20),
  other_variable = c(2, 4, 6, 8)
)

# Fit a linear model
model <- lm(Varroa_Mites ~ other_variable, data = data_clean)

# Generate predictions
predictions <- predict(model, newdata = data_clean)


# Plot the data
plot(predictions, data_clean$varroa_mites, 
     xlab = "Predictions", 
     ylab = "Varroa Mites", 
     main = "Predictions vs Varroa Mites",
     las = 1, # makes y-axis labels horizontal
     cex.lab = 1.2, # increases axis labels size
     cex.axis = 1.2) # increases tick labels size

```

### **Honey Bee Collecting Pollen**

![](/images/Bee%20Feeding.jpg){fig-align="center"}

### Honey Bee with exposed bloated Varroa Mite

![](images/varroa-mite-bee.jpg){fig-align="center"}

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Write the cleaned data to a new CSV file


# Assuming your dataset is named data_hcny
data_hcny_clean <- data_hcny %>% drop_na()


write.csv(data_hcny_clean, here("hcnydata_cleaned.csv"), row.names = FALSE)

#write.csv(hcnydata_cleaned, "C:/Users/ecruz/OneDrive/Documents/UTSA - Data Science Program/Semester Classes/Practicum II Repository/P2-Practicum-II-Portfolio-EdwardCruz/hcny_CleanDraft.csv", row.names = FALSE)
```





